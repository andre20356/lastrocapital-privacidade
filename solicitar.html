<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lastro Capital - Solicitar Emprestimo</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    .container {
      width: 100%;
      max-width: 480px;
    }

    .logo-section {
      text-align: center;
      margin-bottom: 24px;
    }

    .logo {
      width: 80px;
      height: 80px;
      background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
      border-radius: 20px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 16px;
      box-shadow: 0 10px 40px rgba(99, 102, 241, 0.3);
    }

    .logo svg {
      width: 48px;
      height: 48px;
      fill: white;
    }

    .logo-section h1 {
      color: #fff;
      font-size: 28px;
      font-weight: 700;
      margin-bottom: 8px;
    }

    .logo-section p {
      color: rgba(255, 255, 255, 0.7);
      font-size: 16px;
    }

    .form-card {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 24px;
      padding: 32px;
      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
    }

    .form-title {
      font-size: 20px;
      font-weight: 600;
      color: #1a1a2e;
      margin-bottom: 24px;
      text-align: center;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      font-size: 14px;
      font-weight: 500;
      color: #374151;
      margin-bottom: 8px;
    }

    .form-group input,
    .form-group textarea {
      width: 100%;
      padding: 14px 16px;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      font-size: 16px;
      transition: all 0.2s;
      background: #fff;
    }

    .form-group input:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #6366f1;
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
    }

    .form-group textarea {
      resize: vertical;
      min-height: 100px;
    }

    .form-group input::placeholder,
    .form-group textarea::placeholder {
      color: #9ca3af;
    }

    .currency-input {
      position: relative;
    }

    .currency-input span {
      position: absolute;
      left: 16px;
      top: 50%;
      transform: translateY(-50%);
      color: #6b7280;
      font-weight: 500;
    }

    .currency-input input {
      padding-left: 45px;
    }

    .submit-btn {
      width: 100%;
      padding: 16px;
      background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .submit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(99, 102, 241, 0.4);
    }

    .submit-btn:disabled {
      opacity: 0.7;
      cursor: not-allowed;
      transform: none;
    }

    .submit-btn svg {
      width: 20px;
      height: 20px;
      fill: currentColor;
    }

    .success-message {
      display: none;
      text-align: center;
      padding: 40px 20px;
    }

    .success-message.show {
      display: block;
    }

    .success-icon {
      width: 80px;
      height: 80px;
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      border-radius: 50%;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 20px;
    }

    .success-icon svg {
      width: 40px;
      height: 40px;
      fill: white;
    }

    .success-message h2 {
      color: #1a1a2e;
      font-size: 24px;
      margin-bottom: 12px;
    }

    .success-message p {
      color: #6b7280;
      font-size: 16px;
      line-height: 1.5;
    }

    .form-content {
      display: block;
    }

    .form-content.hide {
      display: none;
    }

    .error-message {
      background: #fef2f2;
      border: 1px solid #fecaca;
      color: #dc2626;
      padding: 12px 16px;
      border-radius: 8px;
      margin-bottom: 16px;
      font-size: 14px;
      display: none;
    }

    .error-message.show {
      display: block;
    }

    .loading-spinner {
      width: 20px;
      height: 20px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-top-color: white;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .footer {
      text-align: center;
      margin-top: 24px;
      color: rgba(255, 255, 255, 0.5);
      font-size: 14px;
    }

    @media (max-width: 480px) {
      .form-card {
        padding: 24px;
      }
      
      .logo-section h1 {
        font-size: 24px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="logo-section">
      <div class="logo">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1.41 16.09V20h-2.67v-1.93c-1.71-.36-3.16-1.46-3.27-3.4h1.96c.1 1.05.82 1.87 2.65 1.87 1.96 0 2.4-.98 2.4-1.59 0-.83-.44-1.61-2.67-2.14-2.48-.6-4.18-1.62-4.18-3.67 0-1.72 1.39-2.84 3.11-3.21V4h2.67v1.95c1.86.45 2.79 1.86 2.85 3.39H14.3c-.05-1.11-.64-1.87-2.22-1.87-1.5 0-2.4.68-2.4 1.64 0 .84.65 1.39 2.67 1.91s4.18 1.39 4.18 3.91c-.01 1.83-1.38 2.83-3.12 3.16z"/>
        </svg>
      </div>
      <h1>Lastro Capital</h1>
      <p>Seu parceiro financeiro</p>
    </div>

    <div class="form-card">
      <div class="form-content" id="formContent">
        <h2 class="form-title">Solicitar Emprestimo</h2>
        
        <div class="error-message" id="errorMessage"></div>

        <form id="loanForm">
          <div class="form-group">
            <label for="name">Nome Completo *</label>
            <input type="text" id="name" name="name" placeholder="Digite seu nome completo" required>
          </div>

          <div class="form-group">
            <label for="phone">WhatsApp *</label>
            <input type="tel" id="phone" name="phone" placeholder="(00) 00000-0000" required>
          </div>

          <div class="form-group">
            <label for="email">Email (opcional)</label>
            <input type="email" id="email" name="email" placeholder="seu@email.com">
          </div>

          <div class="form-group">
            <label for="cpf">CPF *</label>
            <input type="text" id="cpf" name="cpf" placeholder="000.000.000-00" required>
          </div>

          <div class="form-group">
            <label for="amount">Valor Desejado *</label>
            <div class="currency-input">
              <span>R$</span>
              <input type="text" id="amount" name="amount" placeholder="0,00" required>
            </div>
          </div>

          <div class="form-group">
            <label for="purpose">Motivo do Emprestimo *</label>
            <textarea id="purpose" name="purpose" placeholder="Descreva brevemente para que precisa do emprestimo..." required></textarea>
          </div>

          <button type="submit" class="submit-btn" id="submitBtn">
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
            </svg>
            Enviar Solicitacao
          </button>
        </form>
      </div>

      <div class="success-message" id="successMessage">
        <div class="success-icon">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
          </svg>
        </div>
        <h2>Solicitacao Enviada!</h2>
        <p>Recebemos sua solicitacao de emprestimo. Entraremos em contato pelo WhatsApp em breve para dar continuidade ao processo.</p>
      </div>
    </div>

    <div class="footer">
      Lastro Capital - Todos os direitos reservados
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDXoVLNhWt3Woz-lK8EIIJ63vr0T6X127A",
      authDomain: "lastrocapital-fb4e8.firebaseapp.com",
      projectId: "lastrocapital-fb4e8",
      storageBucket: "lastrocapital-fb4e8.firebasestorage.app",
      messagingSenderId: "294962452590",
      appId: "1:294962452590:web:61ee302a4e473e97ecee7f"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    function formatPhone(value) {
      const numbers = value.replace(/\D/g, '');
      if (numbers.length <= 2) return `(${numbers}`;
      if (numbers.length <= 7) return `(${numbers.slice(0, 2)}) ${numbers.slice(2)}`;
      return `(${numbers.slice(0, 2)}) ${numbers.slice(2, 7)}-${numbers.slice(7, 11)}`;
    }

    function formatCPF(value) {
      const numbers = value.replace(/\D/g, '');
      if (numbers.length <= 3) return numbers;
      if (numbers.length <= 6) return `${numbers.slice(0, 3)}.${numbers.slice(3)}`;
      if (numbers.length <= 9) return `${numbers.slice(0, 3)}.${numbers.slice(3, 6)}.${numbers.slice(6)}`;
      return `${numbers.slice(0, 3)}.${numbers.slice(3, 6)}.${numbers.slice(6, 9)}-${numbers.slice(9, 11)}`;
    }

    function formatCurrency(value) {
      const numbers = value.replace(/\D/g, '');
      const amount = (parseInt(numbers) || 0) / 100;
      return amount.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    }

    function parseCurrency(value) {
      const numbers = value.replace(/\D/g, '');
      return (parseInt(numbers) || 0) / 100;
    }

    document.getElementById('phone').addEventListener('input', function(e) {
      e.target.value = formatPhone(e.target.value);
    });

    document.getElementById('cpf').addEventListener('input', function(e) {
      e.target.value = formatCPF(e.target.value);
    });

    document.getElementById('amount').addEventListener('input', function(e) {
      e.target.value = formatCurrency(e.target.value);
    });

    document.getElementById('loanForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const submitBtn = document.getElementById('submitBtn');
      const errorMessage = document.getElementById('errorMessage');
      const formContent = document.getElementById('formContent');
      const successMessage = document.getElementById('successMessage');

      errorMessage.classList.remove('show');
      submitBtn.disabled = true;
      submitBtn.innerHTML = '<div class="loading-spinner"></div> Enviando...';

      try {
        const formData = {
          name: document.getElementById('name').value.trim(),
          phone: document.getElementById('phone').value.trim(),
          email: document.getElementById('email').value.trim() || null,
          cpf: document.getElementById('cpf').value.trim(),
          requestedAmount: parseCurrency(document.getElementById('amount').value),
          purpose: document.getElementById('purpose').value.trim(),
          status: 'pending',
          createdAt: serverTimestamp(),
          source: 'web_form'
        };

        if (!formData.name || !formData.phone || !formData.cpf || !formData.requestedAmount || !formData.purpose) {
          throw new Error('Por favor, preencha todos os campos obrigatorios.');
        }

        if (formData.requestedAmount < 100) {
          throw new Error('O valor minimo para solicitacao e R$ 100,00.');
        }

        await addDoc(collection(db, 'loanRequests'), formData);

        formContent.classList.add('hide');
        successMessage.classList.add('show');

      } catch (error) {
        console.error('Erro ao enviar:', error);
        errorMessage.textContent = error.message || 'Erro ao enviar solicitacao. Tente novamente.';
        errorMessage.classList.add('show');
        submitBtn.disabled = false;
        submitBtn.innerHTML = '<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg> Enviar Solicitacao';
      }
    });
  </script>
</body>
</html>
